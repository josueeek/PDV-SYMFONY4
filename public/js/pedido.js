function montaLista(t){$("#choose-items").empty(),$.each(t,function(t,e){var o=$("<tr/>");$("<td/>").html("<input type='radio' value='"+e.id+"' name='item' class='checkb' />").appendTo(o),$("<td/>").html(e.nome).appendTo(o),$("<td/>").html(e.precoUnitario).appendTo(o),$("<td/>").html(e.codigo).appendTo(o),o.appendTo($("#choose-items"))}),$("#modal").modal("show")}function itemPedido(){return items=[],$.each($("tr[data-id]"),function(t,e){item={};var o=$.parseHTML(e.innerHTML);item.produto_id=e.getAttribute("data-id"),item.quantidade=parseFloat(o[2].innerText).toFixed(2),item.percentualDesconto=parseFloat(o[3].innerText).toFixed(2),item.precoUnitario=parseFloat(o[1].innerText).toFixed(2),item.total=parseFloat(o[4].innerText).toFixed(2),items.push(item)}),items}function montaListaPessoas(t){$.each(t,function(t,e){$("select[name=cliente_id]").append('<option value="'+e.id+'">'+e.nome+"</option>")})}$(document).ready(function(){$.ajax({url:"/pessoa",type:"POST",dataType:"json",data:{api:1}}).done(function(t){montaListaPessoas(t)})}),$("#finish").submit(function(t){t.preventDefault(),json={},json.cliente_id=$("#cliente_id").val(),json.total=parseFloat($("#total").html()).toFixed(2),json.items=itemPedido(),console.log(json),$.ajax({url:"/pedido/register",type:"POST",dataType:"json",data:json}).done(function(t){t.errors?$.each(t.errors,function(t,e){$.notify({icon:"pe-7s-attention",message:e},{type:"danger"})}):$.notify({icon:"pe-7s-info",message:"O pedido foi registrado!"},{type:"success"})})}),$("#search").click(function(){var t=$("#term").val();$.ajax({url:"/produto/search",type:"POST",dataType:"json",data:{term:t,api:1}}).done(function(t){montaLista(t)})}),$("#itemForm").submit(function(t){t.preventDefault(),$("#modal").modal("hide"),$.each($(".checkb:checked"),function(t,e){var o=$(this).parent().parent().children("td")[1].innerText,a=parseFloat($(this).parent().parent().children("td")[2].innerText),n=parseFloat($("#quantidade").val()),i=parseFloat($("#porcentagem").val()),d=(a-a*(i/100))*n,r=$("<tr/>").attr("data-id",$(this).val());$("<td/>").html(o).appendTo(r),$("<td/>").html(a.toFixed(2)).appendTo(r),$("<td/>").html(n.toFixed(2)).appendTo(r),$("<td/>").html(i.toFixed(2)).appendTo(r),$("<td/>").attr("data-total",d.toFixed(2)).html(d.toFixed(2)).appendTo(r),$("<td/>").html("<button class='removeItem btn btn-danger'>X</button>").appendTo(r),r.appendTo($("#items"));var s=parseFloat($("#total").text())+d;$("#total").html(s.toFixed(2))}),$("#choose-items").empty()}),$(document).on("click",".removeItem",function(){var t=$(this).parent().parent(),e=parseFloat($("#total").text())-parseFloat(t.children("td[data-total]")[0].innerText);$("#total").html(e.toFixed(2)),console.log(t),t.remove()}),$(document).ready(function(){$(window).keydown(function(t){if(13==t.keyCode)return t.preventDefault(),!1})});